### clearing memory
rm(list = ls())

### setting the working directory
setwd("C:/Users/Guro/Google Drive/MSc Security Risk Management/3rd Semester/SNA/R") ### for Guro

## Setting the working directory (in Mac)
### setting the working directory
setwd("~/Desktop/DIPCON")

### install packages for graph illustrations and 
install.packages("dplyr") ## basic function
install.packages("igraph") ## graph illustration
install.packages("ggplot2") ## for elegant and complex plot graphs
install.packages("ggthemes") ## add-on to ggplot2

## loading packages
library(dplyr)
library(igraph)
library(ggplot2)
library(ggthemes)

## loading the data
df <- read.csv("DIPCON_3.0_Dyads.csv") # data and documentation from: http://www.u.arizona.edu/~volgy/data.html

## inspecting the data
df

### using dplyr to keep only relations for 2000
df2000 <- df %>% # selecting th data set
  filter(dipcon2000 > 0) %>% # keeping only the connections in 2000
  select(abbrev1, abbrev2) # selecting the variables
  
### using dplyr to keep only relations for 2005
df2005 <- df %>% # selecting th data set
  filter(dipcon2005 > 0) %>% # keeping only the connections in 2005
  select(abbrev1, abbrev2) # selecting the variables
  
### using dplyr to keep only relations for 2010
df2010 <- df %>% # selecting th data set
  filter(dipcon2010 > 0) %>% # keeping only the connections in 2010
  select(abbrev1, abbrev2) # selecting the variables
  
#Turning into a graph object
g2000 <- graph.data.frame(df2000, directed = F) # storing the graph as "undirected" for the sake of simplicity
g2005 <- graph.data.frame(df2005, directed = F) # storing the graph as "undirected" for the sake of simplicity
g2010 <- graph.data.frame(df2010, directed = F) # storing the graph as "undirected" for the sake of simplicity

### how many diplomatic ties does a country have on average in 2010
mean(degree(g2000))
mean(degree(g2005))
mean(degree(g2010))


### What is the density?
graph.density(g2000)
graph.density(g2005)
graph.density(g2010)

#### Plotting the graphs: 2000
plot.igraph(g2000, 
            vertex.color = 'lightblue', ### colour of node
            edge.label=df2000$value, ### adding names to the nodes
            vertex.size=5, ### size of node
            edge.color="darkgreen", ### colour of edge
            vertex.label.font= 1, ### font of node 
            vertex.label.cex = 1, ### size of node name label
            main='Diplomatic relations between states - 2000') ### Heading of graph

### Plotting the graphs: 2005
plot.igraph(g2005, 
            vertex.color = 'lightblue', ### colour of node
            edge.label=df2005$value, ### adding names to the nodes
            vertex.size=5, ### size of node
            edge.color="darkgreen", ### colour of edge
            vertex.label.font= 1, ### font of node 
            vertex.label.cex = 1, ### size of node name label
            main='Diplomatic relations between states - 2005') ### Heading of graph

### Plotting the graphs: 2010
plot.igraph(g2010, 
            vertex.color = 'lightblue', ### colour of node
            edge.label=df2010$value, ### adding names to the nodes
            vertex.size=5, ### size of node
            edge.color="darkgreen", ### colour of edge
            vertex.label.font= 1, ### font of node 
            vertex.label.cex = 1, ### size of node name label
            main='Diplomatic relations between states - 2010') ### Heading of graph


## exporting to gephi
write.graph(g2000, "dipcon2000.graphml", format = "graphml")
write.graph(g2005, "dipcon2005.graphml", format = "graphml")
write.graph(g2000, "dipcon2010.graphml", format = "graphml")
